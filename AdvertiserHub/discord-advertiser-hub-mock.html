<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Discord Advertiser Hub (Mock)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
      const { useState } = React;

      function AdvertiserHubMock() {
        const partners = [
          { id: 'gamesight', name: 'Gamesight', description: 'Player-level insights and attribution for PC & Console game launches.', mockTerms: `Gamesight Integration - Terms of Use\n\n1. Data Sharing: Advertiser grants Gamesight access to aggregate campaign event data for attribution and optimization.\n2. Retention: Data retained for 90 days for performance reporting.\n3. Use: Data may be used to compute attribution, audiences, and performance metrics.\n4. Compliance: Advertiser certifies they have necessary user consents for the shared data.\n5. Liability: Mock terms only - this is a demo contract.` },
          { id: 'appsflyer', name: 'AppsFlyer', description: 'Mobile attribution and measurement for app install campaigns.', mockTerms: `AppsFlyer Integration - Terms of Use\n\n1. Data Sharing: Advertiser allows AppsFlyer to receive attribution pings and install data.\n2. Retention: Device-level attribution is hashed and stored up to 180 days.\n3. Use: Metrics may be used for optimization, fraud detection, and reporting.\n4. Compliance: Advertiser responsible for mobile privacy disclosures.\n5. Liability: Mock terms only - this is a demo contract.` },
          { id: 'custom_audiences', name: 'Custom Audiences', description: 'Upload and activate hashed audiences for campaign targeting.', mockTerms: `Custom Audiences - Terms of Use\n\n1. Data Upload: Advertiser will upload only hashed and compliant identifiers.\n2. Retention: Audiences expire after 365 days unless refreshed.\n3. Use: Audiences used for campaign targeting and measurement only.\n4. Compliance: Advertiser confirms lawful basis and required user consents.\n5. Liability: Mock terms only - this is a demo contract.` },
        ];

        const [selected, setSelected] = useState(null);
        const [signedContracts, setSignedContracts] = useState({});
        const [advertiserName, setAdvertiserName] = useState('ACME Studios');
        const [campaignName, setCampaignName] = useState('Launch Campaign');
        const [showToast, setShowToast] = useState(false);

        function openTerms(partner) { setSelected(partner); }
        function closeTerms() { setSelected(null); }
        function agreeSingleClick(partnerId) {
          const ts = new Date().toISOString();
          setSignedContracts((s) => ({ ...s, [partnerId]: { advertiser: advertiserName, campaign: campaignName, agreedAt: ts } }));
          setShowToast(true);
          setTimeout(() => setShowToast(false), 3000);
          closeTerms();
        }
        function revokeAgreement(partnerId) {
          setSignedContracts((s) => { const next = { ...s }; delete next[partnerId]; return next; });
        }

        return (
          <div className="min-h-screen bg-gradient-to-b from-[#f7f7fb] to-white p-8">
            <header className="max-w-5xl mx-auto mb-8">
              <div className="flex items-center justify-between">
                <div>
                  <h1 className="text-3xl font-extrabold">Discord Advertiser Hub (Mock)</h1>
                  <p className="text-sm text-slate-600 mt-1">Quickly review and accept partner contracts with a single click — demo mode.</p>
                </div>
                <div className="bg-white p-3 rounded-2xl shadow-sm flex items-center gap-3">
                  <div className="text-xs text-slate-500">Advertiser</div>
                  <input value={advertiserName} onChange={(e) => setAdvertiserName(e.target.value)} className="w-44 text-sm border border-slate-200 rounded px-2 py-1"/>
                  <div className="text-xs text-slate-500">Campaign</div>
                  <input value={campaignName} onChange={(e) => setCampaignName(e.target.value)} className="w-44 text-sm border border-slate-200 rounded px-2 py-1"/>
                </div>
              </div>
            </header>

            <main className="max-w-5xl mx-auto grid lg:grid-cols-3 gap-6">
              <section className="lg:col-span-2">
                <div className="grid gap-4">
                  {partners.map((p) => {
                    const signed = signedContracts[p.id];
                    return (
                      <article key={p.id} className="bg-white rounded-2xl p-4 shadow hover:shadow-md transition">
                        <div className="flex items-start justify-between">
                          <div>
                            <h2 className="text-lg font-semibold">{p.name}</h2>
                            <p className="text-sm text-slate-600 mt-1">{p.description}</p>
                          </div>
                          <div className="flex flex-col items-end gap-3">
                            {signed ? (
                              <div className="text-right">
                                <div className="text-xs text-slate-500">Agreed</div>
                                <div className="text-sm font-medium">{new Date(signed.agreedAt).toLocaleString()}</div>
                                <button onClick={() => revokeAgreement(p.id)} className="mt-2 text-xs text-red-600 underline">Revoke</button>
                              </div>
                            ) : (
                              <div className="flex items-center gap-2">
                                <button onClick={() => openTerms(p)} className="px-3 py-2 bg-indigo-600 text-white rounded-lg text-sm shadow">View Terms</button>
                                <button onClick={() => agreeSingleClick(p.id)} className="px-3 py-2 border border-indigo-600 text-indigo-600 rounded-lg text-sm hover:bg-indigo-50">Agree & Activate</button>
                              </div>
                            )}
                          </div>
                        </div>
                      </article>
                    );
                  })}
                </div>
              </section>
              <aside className="bg-white rounded-2xl p-4 shadow">
                <h3 className="font-semibold">Active Agreements</h3>
                <ul className="mt-4 space-y-3">
                  {Object.keys(signedContracts).length === 0 && <li className="text-sm text-slate-500">No active agreements yet.</li>}
                  {Object.entries(signedContracts).map(([k, v]) => (
                    <li key={k} className="border border-slate-100 rounded p-3">
                      <div className="flex justify-between items-start">
                        <div><div className="text-sm font-medium">{partners.find(x => x.id === k)?.name}</div><div className="text-xs text-slate-500">{v.advertiser} • {v.campaign}</div></div>
                        <div className="text-xs text-slate-400">{new Date(v.agreedAt).toLocaleString()}</div>
                      </div>
                    </li>
                  ))}
                </ul>
              </aside>
            </main>

            {selected && (
              <div className="fixed inset-0 z-50 flex items-center justify-center">
                <div className="absolute inset-0 bg-black/30" onClick={closeTerms}/>
                <div className="relative bg-white w-[90%] max-w-2xl rounded-2xl shadow-lg p-6">
                  <div className="flex items-start justify-between">
                    <h3 className="text-xl font-semibold">{selected.name} — Mock Terms</h3>
                    <button onClick={closeTerms} className="text-slate-500">Close</button>
                  </div>
                  <pre className="mt-4 bg-slate-50 p-4 rounded text-sm whitespace-pre-wrap">{selected.mockTerms}</pre>
                  <div className="mt-4 flex items-center justify-end gap-3">
                    <button onClick={closeTerms} className="px-4 py-2 rounded border">Cancel</button>
                    <button onClick={() => agreeSingleClick(selected.id)} className="px-5 py-2 bg-indigo-600 text-white rounded font-medium shadow">Single-Click Agree & Activate</button>
                  </div>
                </div>
              </div>
            )}
            {showToast && (<div className="fixed right-6 bottom-6 z-50"><div className="bg-white px-4 py-3 rounded-lg shadow-md border"><div className="text-sm font-medium">Agreement recorded</div></div></div>)}
          </div>
        );
      }

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<AdvertiserHubMock />);
    </script>
  </body>
</html>
